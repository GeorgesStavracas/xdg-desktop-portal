.. _org.freedesktop.impl.portal.ScreenCast:

======================================
org.freedesktop.impl.portal.ScreenCast
======================================

-----------
Description
-----------

.. _org.freedesktop.impl.portal.ScreenCast Description:

Screen cast portal backend interface

The Screen cast portal allows to create screen cast sessions.

This documentation describes version 4 of this interface.



----------
Properties
----------

.. org.freedesktop.impl.portal.ScreenCast Properties:

org.freedesktop.impl.portal.ScreenCast:AvailableSourceTypes
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    AvailableSourceTypes readable u


A bitmask of available source types. Currently defined types are:

<simplelist>
<member>1: MONITOR</member>
<member>2: WINDOW</member>
<member>4: VIRTUAL</member>
</simplelist>




org.freedesktop.impl.portal.ScreenCast:AvailableCursorModes
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    AvailableCursorModes readable u


Available cursor mode values:
<simplelist>
<member>1: Hidden. The cursor is not part of the screen cast stream.</member>
<member>2: Embedded: The cursor is embedded as part of the stream buffers.</member>
<member>4: Metadata: The cursor is not part of the screen cast stream, but sent as PipeWire stream metadata.</member>
</simplelist>




org.freedesktop.impl.portal.ScreenCast:version
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    version readable u




-------
Methods
-------

.. org.freedesktop.impl.portal.ScreenCast Methods:

org.freedesktop.impl.portal.ScreenCast.CreateSession
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    CreateSession (
      IN handle o,
      IN session_handle o,
      IN app_id s,
      IN options a{sv},
      OUT response u,
      OUT results a{sv}
    )



Create a screen cast session.

The following results get returned via the `org.freedesktop.portal.Request::Response`_ signal:
<variablelist>
<varlistentry>
<term>session_id s</term>
<listitem><para>
The session id. A string representing the created screen cast session.
</para></listitem>
</varlistentry>
</variablelist>



handle
  Object path for the `org.freedesktop.impl.portal.Request`_ object representing this call

session_handle
  Object path for the `org.freedesktop.impl.portal.Session`_ object representing the session being created

app_id
  App id of the application

options
  Vardict with optional further information



org.freedesktop.impl.portal.ScreenCast.SelectSources
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    SelectSources (
      IN handle o,
      IN session_handle o,
      IN app_id s,
      IN options a{sv},
      OUT response u,
      OUT results a{sv}
    )



Configure what the screen cast session should record.

Supported keys in the ``options`` vardict include:
<variablelist>
<varlistentry>
<term>types u</term>
<listitem><para>
Bitmask of what type of content to record. Default is MONITOR.
</para></listitem>
</varlistentry>
<varlistentry>
<term>multiple b</term>
<listitem><para>
Whether to allow selecting multiple sources. Default is no.
</para></listitem>
</varlistentry>
<varlistentry>
<term>restore_data (suv)</term>
<listitem><para>
The data to restore from a previous session.
</para>
<para>
If the stored session cannot be restored, this value is ignored
and the user will be prompted normally. This may happen when, for
example, the session contains a monitor or a window that is not
available anymore, or when the stored permissions are withdrawn.
</para>
<para>
The restore data is composed of the vendor name (e.g. "GNOME" or
"KDE"), the version of the implementation-specific private data,
and the implementation-specific private data itself.
</para>
<para>
This option was added in version 4 of this interface.
</para></listitem>
</varlistentry>
<varlistentry>
<term>persist_mode u</term>
<listitem><para>
How this session should persist. Default is 0. Accepted values are:
</para>
<para>
<simplelist>
<member>0: Do not persist (default)</member>
<member>1: Permissions persist as long as the application is running</member>
<member>2: Permissions persist until explicitly revoked</member>
</simplelist>
</para>
<para>
If the permission for the session to persist is granted,
"persist_mode" will be returned via the
`org.freedesktop.portal.Request::Response`_ signal of the
`org.freedesktop.impl.portal.ScreenCast`_.Start method.
</para>
<para>
This option was added in version 4 of this interface.
</para></listitem>
</varlistentry>
</variablelist>

For available source types, see the AvailableSourceTypes property.



handle
  Object path for the `org.freedesktop.impl.portal.Request`_ object representing this call

session_handle
  Object path for the `org.freedesktop.impl.portal.Session`_ object representing the session

app_id
  App id of the application

options
  Vardict with optional further information



org.freedesktop.impl.portal.ScreenCast.Start
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    Start (
      IN handle o,
      IN session_handle o,
      IN app_id s,
      IN parent_window s,
      IN options a{sv},
      OUT response u,
      OUT results a{sv}
    )



Start the screen cast session. This will typically result the portal presenting
a dialog letting the user do the selection set up by SelectSources.

The following results get returned via the `org.freedesktop.portal.Request::Response`_ signal:
<variablelist>
<varlistentry>
<term>streams a(ua{sv})</term>
<listitem><para>
An array of PipeWire streams. Each stream consists of a PipeWire
node ID (the first element in the tuple, and a Vardict of
properties.

The array will contain a single stream if 'multiple' (see
SelectSources) was set to 'false', or at least one stream if
'multiple' was set to 'true' as part of the SelectSources method.
</para></listitem>
</varlistentry>
<varlistentry>
<term>persist_mode u</term>
<listitem><para>
Portal implementations can optionally offer ways to "reduce" the
persist mode, for example by explicitly asking the user. See the
'persist_mode' option of SelectSources for a list of possible
values.

If no persist mode is returned by the Start request, it is assumed
to be the same persist mode received during SelectSources.

This option was added in version 4 of this interface.
</para></listitem>
</varlistentry>
<varlistentry>
<term>restore_data (suv)</term>
<listitem><para>
The data to be restored. This is the data that a portal
implementation sent in reaction to transient or persistent
modes.
</para>
<para>
This data will be stored in the permission store if the effective
persist mode is 2, and may be passed in the future as part of the
SelectSources() method call. The portal backend should store enough
information in 'restore_data' to be able to restore the session
later. The portal backend can deal with unavailable sources however
they see fit.
</para>
<para>
Data generated by a portal implementation must be consumable by
the same portal implementation, but not necessarily by others.
Thus, it is important to properly handle 'restore_data' not being
in a valid format. This may happen when, e.g., the user switched
to another desktop environment, or is using a different portal
implementation.
</para>
<para>
This response option was added in version 4 of this interface.
</para></listitem>
</varlistentry>
</variablelist>

Stream properties include:
<variablelist>
<varlistentry>
<term>position (ii)</term>
<listitem><para>
A tuple consisting of the position (x, y) in the compositor
coordinate space. Note that the position may not be equivalent to a
position in a pixel coordinate space. Only available for monitor
streams.
</para></listitem>
</varlistentry>
<varlistentry>
<term>size (ii)</term>
<listitem><para>
A tuple consisting of (width, height). The size represents the size
of the stream as it is displayed in the compositor coordinate
space. Note that this size may not be equivalent to a size in a
pixel coordinate space. The size may differ from the size of the
stream.
</para></listitem>
</varlistentry>
<varlistentry>
<term>source_type u</term>
<listitem><para>
The type of the content which is being screen casted.
For available source types, see the AvailableSourceTypes property.
This property was added in version 3 of this interface.
</para></listitem>
</varlistentry>
</variablelist>



handle
  Object path for the `org.freedesktop.impl.portal.Request`_ object representing this call

session_handle
  Object path for the `org.freedesktop.impl.portal.Session`_ object representing the session

app_id
  App id of the application

parent_window
  Identifier for the application window, see <link linkend="parent_window">Common Conventions</link>

options
  Vardict with optional further information


